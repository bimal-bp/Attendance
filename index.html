<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labour Attendance Entry System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #27ae60;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-bottom: 40px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h1 i {
            color: var(--secondary);
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: var(--gray);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background-color: var(--accent);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }
        
        .section-title {
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--secondary);
        }
        
        .control-section {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            position: sticky;
            top: 10px;
            z-index: 100;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .category-options {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .category-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .category-option input[type="radio"] {
            display: none;
        }
        
        .category-label {
            padding: 10px 20px;
            background-color: var(--light);
            border-radius: 5px;
            border: 2px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .category-option input[type="radio"]:checked + .category-label {
            background-color: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .inline-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .inline-group .form-control {
            max-width: 150px;
        }
        
        .calculation-box {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--success);
            margin-top: 20px;
        }
        
        .calculation-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .calculation-row:last-child {
            margin-bottom: 0;
            font-weight: bold;
            font-size: 18px;
            color: var(--primary);
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }
        
        .attendance-table-section {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        th {
            background-color: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .present-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .remarks-section {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        textarea {
            width: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            min-height: 100px;
            resize: vertical;
        }
        
        .file-upload {
            margin-top: 20px;
        }
        
        .file-upload-label {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background-color: var(--light);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .file-upload-label:hover {
            background-color: #dfe6e9;
        }
        
        .file-upload input {
            display: none;
        }
        
        .footer-actions {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 30px;
        }
        
        .message {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }
        
        .message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .mobile-label {
            display: none;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .form-group {
                min-width: 100%;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .footer-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .category-options {
                flex-direction: column;
            }
            
            .mobile-label {
                display: block;
            }
            
            table {
                display: block;
            }
            
            thead {
                display: none;
            }
            
            tr {
                display: block;
                margin-bottom: 20px;
                border: 1px solid #ddd;
                border-radius: 5px;
                padding: 15px;
            }
            
            td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px 0;
                border-bottom: 1px solid #eee;
            }
            
            td:last-child {
                border-bottom: none;
            }
            
            td::before {
                content: attr(data-label);
                font-weight: 600;
                color: var(--primary);
            }
        }
        
        .required::after {
            content: " *";
            color: var(--accent);
        }
        
        .empty-table-message {
            text-align: center;
            padding: 40px;
            color: var(--gray);
            font-style: italic;
        }
        
        .no-labour-message {
            background-color: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ffeaa7;
            text-align: center;
            margin-top: 20px;
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <h1><i class="fas fa-clipboard-check"></i> Labour Attendance Entry System</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="viewPreviousBtn">
                        <i class="fas fa-history"></i> View Previous
                    </button>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <!-- Success/Error Message -->
        <div class="message" id="message"></div>
        
        <!-- Top Control Section -->
        <section class="control-section">
            <h2 class="section-title"><i class="fas fa-cogs"></i> Attendance Controls</h2>
            
            <!-- Basic Details -->
            <div class="form-row">
                <div class="form-group">
                    <label for="company" class="required">Company</label>
                    <select id="company" class="form-control">
                        <option value="">Select Company</option>
                        <option value="ABC Construction">ABC Construction</option>
                        <option value="XYZ Builders">XYZ Builders</option>
                        <option value="Infra Corp">Infra Corp</option>
                        <option value="Metro Projects">Metro Projects</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="branch" class="required">Branch / Site</label>
                    <select id="branch" class="form-control">
                        <option value="">Select Branch/Site</option>
                        <option value="Site A - Downtown">Site A - Downtown</option>
                        <option value="Site B - Suburb">Site B - Suburb</option>
                        <option value="Site C - Industrial Area">Site C - Industrial Area</option>
                        <option value="Head Office">Head Office</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="date" class="required">Date</label>
                    <input type="date" id="date" class="form-control" value="">
                </div>
                
                <div class="form-group">
                    <label for="shift" class="required">Shift</label>
                    <select id="shift" class="form-control">
                        <option value="Day">Day</option>
                        <option value="Night">Night</option>
                        <option value="General">General</option>
                    </select>
                </div>
            </div>
            
            <!-- Labour Category -->
            <div class="form-group">
                <label class="required">Labour Category</label>
                <div class="category-options">
                    <div class="category-option">
                        <input type="radio" id="skilled" name="labourCategory" value="Skilled">
                        <label for="skilled" class="category-label">Skilled</label>
                    </div>
                    <div class="category-option">
                        <input type="radio" id="unskilled" name="labourCategory" value="Unskilled">
                        <label for="unskilled" class="category-label">Unskilled</label>
                    </div>
                    <div class="category-option">
                        <input type="radio" id="otherCategory" name="labourCategory" value="Other">
                        <label for="otherCategory" class="category-label">Other</label>
                    </div>
                </div>
                
                <div class="inline-group">
                    <label for="labourCount" class="required">Number of Labour (NMR count)</label>
                    <input type="number" id="labourCount" class="form-control" min="1" max="100" value="5">
                    <button class="btn btn-primary" id="generateTableBtn">Generate Table</button>
                </div>
            </div>
            
            <!-- Purpose of Work -->
            <div class="form-row">
                <div class="form-group">
                    <label for="purpose" class="required">Purpose of Work</label>
                    <select id="purpose" class="form-control">
                        <option value="Development">Development</option>
                        <option value="Production">Production</option>
                        <option value="Maintenance">Maintenance</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group" id="purposeRemarkContainer" style="display: none;">
                    <label for="purposeRemark">Remark (for Other)</label>
                    <input type="text" id="purposeRemark" class="form-control" placeholder="Enter purpose details">
                </div>
            </div>
            
            <!-- Time Details -->
            <div class="form-row">
                <div class="form-group">
                    <label for="inTime" class="required">In Time</label>
                    <input type="time" id="inTime" class="form-control" value="09:00">
                </div>
                
                <div class="form-group">
                    <label for="outTime" class="required">Out Time</label>
                    <input type="time" id="outTime" class="form-control" value="18:00">
                </div>
                
                <div class="form-group">
                    <label>Total Working Hours</label>
                    <div class="form-control" id="totalHours" style="background-color: #f8f9fa; font-weight: bold;">
                        9.00 hours
                    </div>
                </div>
            </div>
            
            <!-- Wages Section -->
            <div class="form-row">
                <div class="form-group">
                    <label for="wageType" class="required">Wage Type</label>
                    <select id="wageType" class="form-control">
                        <option value="Per Day">Per Day</option>
                        <option value="Per Hour">Per Hour</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="wageAmount" class="required">Wage Amount (₹)</label>
                    <input type="number" id="wageAmount" class="form-control" min="100" step="50" value="500">
                </div>
                
                <div class="form-group">
                    <label>Total Wages</label>
                    <div class="form-control" id="totalWages" style="background-color: #f8f9fa; font-weight: bold;">
                        ₹ 2,500
                    </div>
                </div>
            </div>
            
            <!-- Calculation Summary -->
            <div class="calculation-box">
                <div class="calculation-row">
                    <span>Labour Count:</span>
                    <span id="summaryLabourCount">5</span>
                </div>
                <div class="calculation-row">
                    <span>Working Hours:</span>
                    <span id="summaryWorkingHours">9.00 hours</span>
                </div>
                <div class="calculation-row">
                    <span>Total Wages:</span>
                    <span id="summaryTotalWages">₹ 2,500</span>
                </div>
            </div>
        </section>
        
        <!-- Attendance Entry Table -->
        <section class="attendance-table-section">
            <h2 class="section-title"><i class="fas fa-users"></i> Labour Attendance Entry</h2>
            
            <div class="no-labour-message" id="noLabourMessage">
                <i class="fas fa-info-circle"></i> Please select a labour category and number of labour above, then click "Generate Table" to create the attendance entry table.
            </div>
            
            <div id="attendanceTableContainer">
                <!-- Table will be generated here by JavaScript -->
            </div>
        </section>
        
        <!-- Additional Fields -->
        <section class="remarks-section">
            <h2 class="section-title"><i class="fas fa-paperclip"></i> Additional Information</h2>
            
            <div class="form-group">
                <label for="remarks">Remarks</label>
                <textarea id="remarks" placeholder="Enter any additional remarks or notes here..."></textarea>
            </div>
            
            <div class="file-upload">
                <label class="file-upload-label">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Upload Attendance Proof (Image/PDF)</span>
                    <input type="file" id="attendanceProof" accept=".jpg,.jpeg,.png,.pdf">
                </label>
                <div id="fileName" style="margin-top: 10px; font-style: italic; color: var(--gray);"></div>
            </div>
        </section>
        
        <!-- Action Buttons -->
        <div class="footer-actions">
            <div>
                <button class="btn btn-success" id="saveBtn">
                    <i class="fas fa-save"></i> Save Attendance
                </button>
                <button class="btn btn-primary" id="saveNewBtn">
                    <i class="fas fa-plus-circle"></i> Save & New Entry
                </button>
            </div>
            
            <div>
                <button class="btn btn-secondary" id="resetBtn">
                    <i class="fas fa-redo"></i> Reset
                </button>
                <button class="btn btn-danger" id="cancelBtn">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            
            // Initialize the table with default values
            generateAttendanceTable();
            
            // Event Listeners
            document.getElementById('generateTableBtn').addEventListener('click', generateAttendanceTable);
            document.getElementById('labourCount').addEventListener('change', updateCalculations);
            document.getElementById('labourCount').addEventListener('input', updateCalculations);
            document.getElementById('inTime').addEventListener('change', updateWorkingHours);
            document.getElementById('outTime').addEventListener('change', updateWorkingHours);
            document.getElementById('wageAmount').addEventListener('input', updateCalculations);
            document.getElementById('wageType').addEventListener('change', updateCalculations);
            document.getElementById('purpose').addEventListener('change', function() {
                const remarkContainer = document.getElementById('purposeRemarkContainer');
                remarkContainer.style.display = this.value === 'Other' ? 'block' : 'none';
            });
            
            // Labour category selection
            document.querySelectorAll('input[name="labourCategory"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    updateCalculations();
                });
            });
            
            // File upload display
            document.getElementById('attendanceProof').addEventListener('change', function() {
                const fileName = this.files.length > 0 ? this.files[0].name : '';
                document.getElementById('fileName').textContent = fileName ? `Selected file: ${fileName}` : '';
            });
            
            // Button actions
            document.getElementById('saveBtn').addEventListener('click', saveAttendance);
            document.getElementById('saveNewBtn').addEventListener('click', saveAndNew);
            document.getElementById('resetBtn').addEventListener('click', resetForm);
            document.getElementById('cancelBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to cancel? All unsaved data will be lost.')) {
                    resetForm();
                }
            });
            document.getElementById('viewPreviousBtn').addEventListener('click', function() {
                showMessage('This feature would show previous attendance records in a real application.', 'info');
            });
            
            // Initial calculations
            updateWorkingHours();
            updateCalculations();
        });
        
        // Generate the attendance table based on labour count
        function generateAttendanceTable() {
            const labourCount = parseInt(document.getElementById('labourCount').value) || 0;
            const labourCategory = document.querySelector('input[name="labourCategory"]:checked');
            const categoryValue = labourCategory ? labourCategory.value : 'Skilled';
            const tableContainer = document.getElementById('attendanceTableContainer');
            const noLabourMessage = document.getElementById('noLabourMessage');
            
            if (labourCount <= 0 || !labourCategory) {
                tableContainer.innerHTML = '';
                noLabourMessage.style.display = 'block';
                return;
            }
            
            noLabourMessage.style.display = 'none';
            
            // Vendor options (would typically come from database)
            const vendorOptions = [
                'Select Vendor',
                'Vendor A',
                'Vendor B',
                'Vendor C',
                'Direct Labour'
            ];
            
            let tableHTML = `
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Sr No</th>
                            <th>Labour Name</th>
                            <th>Labour Type</th>
                            <th>Vendor</th>
                            <th>Present</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            for (let i = 1; i <= labourCount; i++) {
                tableHTML += `
                <tr>
                    <td data-label="Sr No">${i}</td>
                    <td data-label="Labour Name">
                        <input type="text" class="form-control labour-name" placeholder="Enter labour name" style="width: 100%;">
                    </td>
                    <td data-label="Labour Type">${categoryValue}</td>
                    <td data-label="Vendor">
                        <select class="form-control labour-vendor">
                            ${vendorOptions.map(option => 
                                `<option value="${option}">${option}</option>`
                            ).join('')}
                        </select>
                    </td>
                    <td data-label="Present">
                        <input type="checkbox" class="present-checkbox" checked>
                    </td>
                </tr>
                `;
            }
            
            tableHTML += `
                    </tbody>
                </table>
            </div>
            `;
            
            tableContainer.innerHTML = tableHTML;
            
            // Add event listeners to checkboxes to update present count
            document.querySelectorAll('.present-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updatePresentCount);
            });
            
            updatePresentCount();
        }
        
        // Calculate working hours
        function updateWorkingHours() {
            const inTime = document.getElementById('inTime').value;
            const outTime = document.getElementById('outTime').value;
            
            if (!inTime || !outTime) {
                document.getElementById('totalHours').textContent = '0.00 hours';
                return;
            }
            
            const inDate = new Date(`2000-01-01T${inTime}`);
            const outDate = new Date(`2000-01-01T${outTime}`);
            
            // Handle overnight shift
            if (outDate < inDate) {
                outDate.setDate(outDate.getDate() + 1);
            }
            
            const diffMs = outDate - inDate;
            const diffHours = diffMs / (1000 * 60 * 60);
            
            document.getElementById('totalHours').textContent = diffHours.toFixed(2) + ' hours';
            updateCalculations();
        }
        
        // Update all calculations
        function updateCalculations() {
            const labourCount = parseInt(document.getElementById('labourCount').value) || 0;
            const wageAmount = parseFloat(document.getElementById('wageAmount').value) || 0;
            const wageType = document.getElementById('wageType').value;
            const totalHours = parseFloat(document.getElementById('totalHours').textContent) || 0;
            
            // Calculate total wages based on wage type
            let totalWages = 0;
            
            if (wageType === 'Per Day') {
                totalWages = labourCount * wageAmount;
            } else if (wageType === 'Per Hour') {
                totalWages = labourCount * wageAmount * totalHours;
            }
            
            // Update total wages display
            document.getElementById('totalWages').textContent = '₹ ' + totalWages.toLocaleString('en-IN');
            
            // Update summary section
            document.getElementById('summaryLabourCount').textContent = labourCount;
            document.getElementById('summaryWorkingHours').textContent = document.getElementById('totalHours').textContent;
            document.getElementById('summaryTotalWages').textContent = '₹ ' + totalWages.toLocaleString('en-IN');
            
            // Update present count if table exists
            updatePresentCount();
        }
        
        // Update present count summary
        function updatePresentCount() {
            const checkboxes = document.querySelectorAll('.present-checkbox');
            const presentCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const labourCount = parseInt(document.getElementById('labourCount').value) || 0;
            
            // In a real application, you might want to display this somewhere
            console.log(`Present: ${presentCount} / ${labourCount}`);
        }
        
        // Save attendance
        function saveAttendance() {
            // Validate required fields
            if (!validateForm()) {
                return;
            }
            
            // Gather all data
            const attendanceData = {
                company: document.getElementById('company').value,
                branch: document.getElementById('branch').value,
                date: document.getElementById('date').value,
                shift: document.getElementById('shift').value,
                labourCategory: document.querySelector('input[name="labourCategory"]:checked').value,
                labourCount: parseInt(document.getElementById('labourCount').value),
                purpose: document.getElementById('purpose').value,
                purposeRemark: document.getElementById('purposeRemark').value,
                inTime: document.getElementById('inTime').value,
                outTime: document.getElementById('outTime').value,
                totalHours: document.getElementById('totalHours').textContent,
                wageType: document.getElementById('wageType').value,
                wageAmount: parseFloat(document.getElementById('wageAmount').value),
                totalWages: document.getElementById('totalWages').textContent,
                remarks: document.getElementById('remarks').value,
                attendanceProof: document.getElementById('attendanceProof').files.length > 0 
                    ? document.getElementById('attendanceProof').files[0].name 
                    : null,
                labourEntries: []
            };
            
            // Gather labour entries from table
            const labourNames = document.querySelectorAll('.labour-name');
            const labourVendors = document.querySelectorAll('.labour-vendor');
            const presentCheckboxes = document.querySelectorAll('.present-checkbox');
            
            for (let i = 0; i < labourNames.length; i++) {
                attendanceData.labourEntries.push({
                    srNo: i + 1,
                    name: labourNames[i].value || `Labour ${i+1}`,
                    type: attendanceData.labourCategory,
                    vendor: labourVendors[i].value,
                    present: presentCheckboxes[i].checked
                });
            }
            
            // In a real application, you would send this data to a server
            console.log('Attendance Data:', attendanceData);
            
            // Show success message
            showMessage('Attendance saved successfully!', 'success');
            
            // In a real application, you might redirect or clear the form
            // For demo, we'll just log the data
            return attendanceData;
        }
        
        // Save and create new entry
        function saveAndNew() {
            const saved = saveAttendance();
            if (saved) {
                // Reset form but keep some values
                document.getElementById('company').value = '';
                document.getElementById('branch').value = '';
                document.getElementById('shift').value = 'Day';
                document.getElementById('labourCount').value = '5';
                document.getElementById('purpose').value = 'Development';
                document.getElementById('purposeRemarkContainer').style.display = 'none';
                document.getElementById('remarks').value = '';
                document.getElementById('fileName').textContent = '';
                
                // Generate new table
                generateAttendanceTable();
                updateCalculations();
                
                showMessage('Attendance saved. Ready for new entry!', 'success');
            }
        }
        
        // Reset form
        function resetForm() {
            if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                document.getElementById('company').value = '';
                document.getElementById('branch').value = '';
                document.getElementById('date').value = new Date().toISOString().split('T')[0];
                document.getElementById('shift').value = 'Day';
                
                // Reset category selection
                document.getElementById('skilled').checked = true;
                
                document.getElementById('labourCount').value = '5';
                document.getElementById('purpose').value = 'Development';
                document.getElementById('purposeRemarkContainer').style.display = 'none';
                document.getElementById('purposeRemark').value = '';
                document.getElementById('inTime').value = '09:00';
                document.getElementById('outTime').value = '18:00';
                document.getElementById('wageType').value = 'Per Day';
                document.getElementById('wageAmount').value = '500';
                document.getElementById('remarks').value = '';
                document.getElementById('attendanceProof').value = '';
                document.getElementById('fileName').textContent = '';
                
                // Regenerate table
                generateAttendanceTable();
                updateWorkingHours();
                updateCalculations();
                
                showMessage('Form has been reset.', 'info');
            }
        }
        
        // Validate form
        function validateForm() {
            const requiredFields = [
                { id: 'company', name: 'Company' },
                { id: 'branch', name: 'Branch/Site' },
                { id: 'date', name: 'Date' },
                { id: 'labourCount', name: 'Number of Labour' },
                { id: 'inTime', name: 'In Time' },
                { id: 'outTime', name: 'Out Time' },
                { id: 'wageAmount', name: 'Wage Amount' }
            ];
            
            // Check labour category
            const labourCategory = document.querySelector('input[name="labourCategory"]:checked');
            if (!labourCategory) {
                showMessage('Please select a Labour Category.', 'error');
                return false;
            }
            
            // Check other required fields
            for (const field of requiredFields) {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    showMessage(`Please fill in the ${field.name} field.`, 'error');
                    element.focus();
                    return false;
                }
            }
            
            // Check labour count is valid
            const labourCount = parseInt(document.getElementById('labourCount').value);
            if (isNaN(labourCount) || labourCount <= 0) {
                showMessage('Please enter a valid number of labour (greater than 0).', 'error');
                document.getElementById('labourCount').focus();
                return false;
            }
            
            return true;
        }
        
        // Show message
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
            }
        }
    </script>
</body>
</html>
